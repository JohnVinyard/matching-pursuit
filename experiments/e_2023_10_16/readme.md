Decompose the loss so that samples, amplitudes and positions all receive direct and independent gradients
